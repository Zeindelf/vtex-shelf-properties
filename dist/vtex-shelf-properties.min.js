/*!!
 * VtexShelfProperties.js v0.3.0
 * https://github.com/zeindelf/vtex-shelf-properties
 *
 * Copyright (c) 2018-2018 Zeindelf
 * Released under the MIT license
 *
 * Date: 2018-03-19T18:21:04.896Z
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e.VTEX=e.VTEX||{},e.VTEX.VtexShelfProperties=t())}(this,function(){"use strict";var e="0.7.0",t={EVENT_TIME:150,MESSAGES:{vtexCatalog:"VtexCatalog.js is required and must be an instance. Download it from https://www.npmjs.com/package/vtex-catalog",vtexCatalogVersion:e,vtexCatalogVersionMessage:"VtexCatalog version must be higher than 0.7.0. Download last version on https://www.npmjs.com/package/vtex-catalog",fnProperties:"Callback must be a function",shelfClass:"shelfClass is required and must be a string, eg. '.js--shelf-class'"}},n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),r=new(function(){function e(){n(this,e)}return s(e,[{key:"_requestEndEvent",value:function(e){setTimeout(function(){return $(document).trigger(e+".vtexShelfProperties")},this._eventTime)}},{key:"_validateShelfClass",value:function(e,n){if(n.isUndefined(e)||!n.isString(e))throw new Error(t.MESSAGES.shelfClass)}}]),e}()),i={setEventName:function(e){this.eventName=e},setShelfContainer:function(e){r._validateShelfClass(e,this.globalHelpers),this.eventName=this.globalHelpers.isUndefined(this.eventName)?"requestEnd":this.eventName,this.shelfClass=e;var t=$(e+":not(.is--loaded)");if(t.length<1)return!1;var n=t.map(function(e,t){return $(t).data("productId")}).get();return this._getProducts(n,t)},setEventTime:function(e){r._eventTime=this.globalHelpers.isNumber(e)?e:CONSTANTS.EVENT_TIME},update:function(){r._validateShelfClass(this.shelfClass,this.globalHelpers),this.setShelfContainer(this.shelfClass)},_getProducts:function(e,t){var n=this;return this.vtexCatalog.searchProductArray(e).then(function(e){t.map(function(t,s){var r=$(s),i=r.data("productId");for(var a in e)({}).hasOwnProperty.call(e,a)&&parseInt(i)===parseInt(a)&&(n.fnProperties.apply(n,[r,e[a]]),r.addClass("is--loaded"))})}).always(function(){return r._requestEndEvent(n.eventName)})}};return function e(s,r,a){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n(this,e),this.version="0.3.0",this.name="@VtexShelfProperties",void 0===s)throw new TypeError(t.MESSAGES.vtexUtils);if("@VtexUtils"!==s.name)throw new TypeError(t.MESSAGES.vtexUtils);if(s.version<t.MESSAGES.vtexUtilsVersion)throw new Error(t.MESSAGES.vtexUtilsVersionMessage);if(!s.globalHelpers.isFunction(a))throw new TypeError(t.MESSAGES.fnProperties);this.fnProperties=a,this.globalHelpers=s.globalHelpers,this.vtexCatalog=new r(s,o),this.globalHelpers.extend(e.prototype,i)}});